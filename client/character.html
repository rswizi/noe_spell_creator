<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Character Manager</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- If you already ship a global CSS, remove the inline styles below. -->
  <style>
    :root{
      --bg:#0b0f1a; --panel:#111827; --muted:#6b7280; --txt:#e5e7eb; --accent:#8b5cf6;
      --b1:#1f2937; --b2:#374151; --ok:#10b981; --warn:#f59e0b; --bad:#ef4444;
    }
    html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,#0b0f1a,#0c1222 30%,#0b0f1a 100%);color:var(--txt);font:14px/1.4 Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';}
    .wrap{max-width:1200px;margin:0 auto;padding:24px}
    .row{display:grid;gap:16px}
    .grid-2{grid-template-columns:1fr 1fr}
    .grid-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    .grid-4{grid-template-columns:repeat(4,minmax(0,1fr))}
    .panel{background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:16px}
    .soft{background:rgba(255,255,255,.04)}
    .title{font-size:20px;font-weight:700;margin:0 0 10px}
    .muted{color:var(--muted)}
    .label{font-size:12px;color:var(--muted)}
    .input,select,textarea{width:100%;box-sizing:border-box;padding:10px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.1);background:#0f172a;color:var(--txt);outline:none}
    .input:focus,select:focus,textarea:focus{border-color:var(--accent)}
    .btn{appearance:none;border:0;border-radius:12px;padding:10px 14px;background:var(--accent);color:white;font-weight:600;cursor:pointer}
    .btn.subtle{background:#1f2937}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,.12)}
    .badge{display:inline-flex;align-items:center;gap:6px;border-radius:999px;padding:4px 10px;background:#111827;border:1px solid rgba(255,255,255,.08);font-size:12px}
    .kpi{display:flex;flex-direction:column;gap:6px}
    .kpi .num{font-size:18px;font-weight:700}
    .bar{height:10px;border-radius:999px;background:#111827;border:1px solid rgba(255,255,255,.08);position:relative;overflow:hidden}
    .bar>i{display:block;height:100%;background:linear-gradient(90deg,#6366f1,#8b5cf6);width:0%}
    .bar.hp>i{background:linear-gradient(90deg,#10b981,#22c55e)}
    .bar.sp>i{background:linear-gradient(90deg,#06b6d4,#22d3ee)}
    .bar.en>i{background:linear-gradient(90deg,#f59e0b,#fbbf24)}
    .bar.fo>i{background:linear-gradient(90deg,#f472b6,#ec4899)}
    .bar.tx>i{background:linear-gradient(90deg,#ef4444,#f97316)}
    .rowline{display:grid;grid-template-columns:220px 1fr 1fr 1fr;gap:8px;align-items:center;padding:8px;border-bottom:1px dashed rgba(255,255,255,.06)}
    .rowline .h{font-weight:600;color:#cbd5e1}
    .rowline .sub{grid-column:1/-1;margin:0 0 4px;color:var(--muted);font-size:12px}
    .mini{font-size:12px;color:var(--muted)}
    .tabs{display:flex;border-bottom:1px solid rgba(255,255,255,.08);gap:8px;margin-top:8px}
    .tab{padding:10px 12px;border-radius:12px 12px 0 0;background:transparent;border:1px solid transparent;border-bottom:0;cursor:pointer}
    .tab.active{background:#0f172a;border-color:rgba(255,255,255,.12)}
    .tabpan{display:none;padding:16px}
    .tabpan.active{display:block}
    .tbl{width:100%;border-collapse:collapse}
    .tbl th,.tbl td{border-bottom:1px solid rgba(255,255,255,.06);padding:8px;text-align:left}
    .tbl th{color:#cbd5e1;font-weight:600}
    .right{text-align:right}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,'Liberation Mono','Courier New',monospace}
    .avatar{width:120px;height:120px;border-radius:16px;object-fit:cover;border:1px solid rgba(255,255,255,.1);background:#0f172a}
    .hint{font-size:12px;color:var(--muted)}
    .divider{height:1px;background:rgba(255,255,255,.06);margin:8px 0 16px}
    .pill{border:1px solid rgba(255,255,255,.08);background:#0f172a;border-radius:999px;padding:6px 10px;display:inline-flex;gap:6px;align-items:center}
    .danger{color:#fecaca}
    .good{color:#bbf7d0}
  </style>
  <script defer src="/static/js/characters.js"></script>
</head>
<body>
  <div class="wrap">
    <!-- Header -->
    <div class="panel">
      <div class="row grid-2">
        <div class="row" style="grid-template-columns:140px 1fr; gap:16px">
          <div>
            <img id="charAvatar" class="avatar" src="https://assets.forge-vtt.com/bazaar/core/icons/svg/mystery-man.svg" alt="">
            <div class="hint" style="margin-top:8px">
              <label class="pill">
                <span class="mini">Image URL</span>
                <input id="avatarUrl" class="input" placeholder="https://…" style="width:240px">
              </label>
            </div>
          </div>
          <div>
            <div class="title">Character</div>
            <div class="row grid-3">
              <label class="kpi">
                <span class="label">Name</span>
                <input id="c_name" class="input" placeholder="Akari of the East">
              </label>
              <label class="kpi">
                <span class="label">Level</span>
                <input id="c_level" type="number" min="1" max="100" class="input" value="1">
              </label>
              <label class="kpi">
                <span class="label">XP</span>
                <input id="c_xp" type="number" min="0" class="input" value="0">
              </label>
            </div>
            <div class="divider"></div>
            <div class="row grid-4">
              <span class="badge">MO: <b id="k_mo" class="mono">4</b></span>
              <span class="badge">Initiative: <b id="k_init" class="mono">4</b></span>
              <span class="badge">ET: <b id="k_et" class="mono">1</b></span>
              <span class="badge">Condition DC: <b id="k_cdc" class="mono">6</b></span>
            </div>
          </div>
        </div>

        <!-- Resource bars -->
        <div class="panel soft">
          <div class="title">Resources</div>
          <div class="row">
            <!-- HP -->
            <div class="row grid-3">
              <div class="kpi">
                <span class="label">HP</span>
                <div class="num"><span id="hp_cur">100</span>/<span id="hp_max">100</span></div>
                <div class="bar hp"><i id="hp_bar"></i></div>
              </div>
              <div class="kpi">
                <span class="label">SP</span>
                <div class="num"><span id="sp_cur">0</span>/<span id="sp_max">10</span></div>
                <div class="bar sp"><i id="sp_bar"></i></div>
              </div>
              <div class="kpi">
                <span class="label">EN</span>
                <div class="num"><span id="en_cur">5</span>/<span id="en_max">5</span></div>
                <div class="bar en"><i id="en_bar"></i></div>
              </div>
            </div>
            <div class="row grid-3">
              <div class="kpi">
                <span class="label">FO</span>
                <div class="num"><span id="fo_cur">2</span>/<span id="fo_max">2</span></div>
                <div class="bar fo"><i id="fo_bar"></i></div>
              </div>
              <div class="kpi">
                <span class="label">TX</span>
                <div class="num"><span id="tx_cur">0</span>/<span id="tx_max">0</span></div>
                <div class="bar tx"><i id="tx_bar"></i></div>
              </div>
              <div class="kpi">
                <span class="label">Enc</span>
                <div class="num"><span id="enc_cur">0</span>/<span id="enc_max">10</span></div>
                <div class="bar"><i id="enc_bar"></i></div>
              </div>
            </div>
            <div class="hint">Max values are derived. Current values are editable in the combat/inventory flows later.</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tabs -->
    <div class="panel" style="margin-top:16px">
      <div class="tabs">
        <button class="tab active" data-tab="stats">Statistics</button>
        <button class="tab" data-tab="inventory">Inventory</button>
        <button class="tab" data-tab="abilities">Abilities</button>
        <button class="tab" data-tab="combat">Combat</button>
        <button class="tab" data-tab="personal">Personal</button>
      </div>

      <!-- Tab: Statistics -->
      <div class="tabpan active" id="tab-stats">
        <!-- Counters -->
        <div class="row grid-3">
          <div class="panel soft">
            <div class="label">Skill Points</div>
            <div class="num mono"><span id="sp_used">0</span> / <span id="sp_max">40</span> <span class="mini">[cap <span id="skill_cap">3</span>]</span></div>
          </div>
          <div class="panel soft">
            <div class="label">Characteristic Points</div>
            <div class="num mono"><span id="cp_used">0</span> / <span id="cp_max">22</span> <span class="mini">[cap <span id="char_cap">10</span>]</span></div>
          </div>
          <div class="panel soft">
            <div class="label">Sublimation</div>
            <div class="num mono"><span id="sub_used">0</span> / <span id="sub_max">0</span></div>
            <div class="mini">Tier cap: <span id="sub_tier">1</span> (I–IV)</div>
          </div>
        </div>

        <!-- Sublimation table -->
        <div class="panel" style="margin-top:16px">
          <div class="row" style="grid-template-columns:1fr auto; align-items:center">
            <div class="title">Sublimations</div>
            <button id="btnAddSub" class="btn subtle">Add Sublimation</button>
          </div>
          <table class="tbl" id="subTable">
            <thead>
              <tr>
                <th style="width:260px">Type</th>
                <th>Skill (for Excellence)</th>
                <th style="width:160px">Tier</th>
                <th class="right" style="width:70px">Slots</th>
                <th style="width:60px"></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <div class="hint">Types: Lethality, Excellence (choose a skill), Blessing, Defense, Speed, Devastation, Clarity, Endurance.</div>
        </div>

        <!-- Characteristics & Skills -->
        <div class="panel" style="margin-top:16px">
          <div class="title">Characteristics & Skills</div>
          <div id="charSkillContainer"></div>
        </div>

        <!-- Intensities -->
        <div class="panel" style="margin-top:16px">
          <div class="title">Intensities</div>
          <table class="tbl" id="intensityTable">
            <thead>
              <tr>
                <th>Name</th>
                <th>Invested</th>
                <th>Modifier</th>
                <th>Base Value</th>
                <th>ID</th>
                <th>IV</th>
                <th class="right">Res/Wk</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <div class="hint">Specialist rule & resistance/weakness grid are computed automatically.</div>
        </div>
      </div>

      <!-- Tab: Inventory -->
      <div class="tabpan" id="tab-inventory">
        <div class="title">Inventory</div>
        <p class="muted">We’ll wire this to your existing inventory system later.</p>
      </div>

      <!-- Tab: Abilities -->
      <div class="tabpan" id="tab-abilities">
        <div class="title">Abilities</div>
        <p class="muted">Coming soon—talents, archetypes, passives, actives.</p>
      </div>

      <!-- Tab: Combat -->
      <div class="tabpan" id="tab-combat">
        <div class="title">Combat</div>
        <p class="muted">This will host current HP/SP/EN/FO, conditions, active spells, etc.</p>
      </div>

      <!-- Tab: Personal -->
      <div class="tabpan" id="tab-personal">
        <div class="row grid-2">
          <div class="panel soft">
            <div class="row grid-3">
              <label><span class="label">Height</span><input id="p_height" class="input" placeholder="175 cm"></label>
              <label><span class="label">Weight</span><input id="p_weight" class="input" placeholder="70 kg"></label>
              <label><span class="label">Birthday</span><input id="p_bday" class="input" placeholder="TBD"></label>
            </div>
          </div>
          <div class="panel soft">
            <label><span class="label">Backstory</span><textarea id="p_backstory" class="input" rows="6" placeholder="Who are they?"></textarea></label>
            <label style="margin-top:8px"><span class="label">Player Notes</span><textarea id="p_notes" class="input" rows="6" placeholder="Anything else"></textarea></label>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>