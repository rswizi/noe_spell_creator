<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NoE - Abilities & Traits</title>
  <link rel="stylesheet" href="/static/style.css" />
  <style>
    :root { color-scheme: dark; }
    body {
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      background:#050507;
      color:#f5f5f5;
    }
    .page { min-height:100vh; display:grid; place-items:center; }
    .wrap { width:100%; max-width:720px; padding:24px 16px 40px; }
    .card {
      border-radius:18px;
      border:1px solid #262626;
      background:radial-gradient(circle at top,#191919 0,#090909 55%,#050505 100%);
      padding:20px 18px 22px;
      box-shadow:0 18px 40px rgba(0,0,0,0.55);
    }
    h1 { margin:0 0 8px; font-size:22px; }
    .muted { opacity:.83; font-size:.95rem; }
    .topbar { display:flex; align-items:center; gap:10px; margin-bottom:16px; }
    .topbar .right { margin-left:auto; }
    .grid { display:grid; gap:12px; margin-top:18px; }
    @media (min-width:640px) {
      .grid { grid-template-columns: repeat(2, minmax(0,1fr)); }
    }
    .tile {
      border-radius:14px;
      border:1px solid #2b2b2b;
      background:#101010;
      padding:14px 12px 14px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .tile h2 { margin:0; font-size:1rem; }
    .tile p { margin:0; font-size:.88rem; opacity:.85; }
    a.btn {
      display:inline-flex;
      justify-content:center;
      align-items:center;
      gap:6px;
      margin-top:8px;
      border-radius:999px;
      border:1px solid #444;
      padding:7px 11px;
      font-size:.9rem;
      text-decoration:none;
      color:#f5f5f5;
      background:#181818;
    }
    a.btn:hover { background:#222; }
  </style>
</head>
<body>
  <div class="page"><div class="wrap">
    <div class="card">
      <div class="topbar">
        <h1>Abilities & Traits</h1>
        <span id="login-chip" class="muted right"></span>
        <a class="btn" href="portal.html">Back to Portal</a>
      </div>
      <p class="muted">
        Catalog of all Active / Passive abilities in Natures of Eclipse.
        Regular users can submit entries for review; moderators and admins can approve and edit.
      </p>

      <div class="grid">
        <div class="tile">
          <h2>Create New Ability</h2>
          <p>Define a new Active, Passive, or Mixed ability and store it in the global database.</p>
          <a class="btn" href="abilities_create.html">Open Creator</a>
        </div>
        <div class="tile">
          <h2>Browse & Edit Abilities</h2>
          <p>Search existing abilities, inspect details, and edit them (if you have permissions).</p>
          <a class="btn" href="abilities_list.html">Open Browser / Editor</a>
        </div>
        <div class="tile">
          <h2>Archetypes Manager</h2>
          <p>Create archetypes, set rank unlock order, link ability versions, and manage hybrid rules.</p>
          <a class="btn" href="archetypes_admin.html">Open Archetype Builder</a>
        </div>
        <div class="tile">
          <h2>Archetype Importer</h2>
          <p>Paste archetype text to auto-create abilities, versions, and the archetype entry.</p>
          <a class="btn" href="archetype_importer.html">Open Importer</a>
        </div>
      </div>
    </div>
  </div></div>

<script>
function getToken(){ return localStorage.getItem('auth_token') || ''; }
function setCookieToken(tok){ if(!tok) return; document.cookie = `token=${tok}; path=/; SameSite=Lax`; }
function authHeaders(){
  const t=getToken(); if(t) setCookieToken(t);
  return t ? {'Authorization':'Bearer '+t, 'X-Auth-Token':t} : {};
}
async function api(path,opt={}){
  const headers = Object.assign({}, opt.headers||{}, authHeaders());
  const resp = await fetch(path, { credentials:'include', ...opt, headers });
  const ct = resp.headers.get('content-type') || '';
  const data = ct.includes('application/json') ? await resp.json() : { status:'error', message: await resp.text() };
  if(!resp.ok || data.status==='error') throw new Error(data.message || ('HTTP '+resp.status));
  return data;
}
const loginChip = document.getElementById('login-chip');
async function checkMe(){
  try{
    const me = await api('/auth/me');
    loginChip.textContent = me.username + ' (' + me.role + ')';
  }catch(e){
    loginChip.textContent = 'Not logged in.';
  }
}
checkMe();
</script>
</body>
</html>
